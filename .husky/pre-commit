#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run lint-staged for code quality checks
npx lint-staged

# Run type checking
npm run type-check

# Check for console.log in production code (excluding tests, stories, mocks)
echo "üîç Checking for console.log usage..."
if git diff --cached --name-only | grep -E '\.(ts|tsx)$' | grep -v -E '(\.stories\.|\.test\.|\.spec\.|__tests__|testUtils)' | xargs grep -n 'console\.\(log\|warn\|error\|info\|debug\)' 2>/dev/null; then
  echo "‚ùå ERROR: console.log found in production code!"
  echo "   Please use logger.debug(), logger.info(), logger.warn(), or logger.error() instead."
  echo "   Import from: import { logger } from '@/utils/logger';"
  exit 1
fi
echo "‚úÖ No console.log found in production code"
